{
  "scoring_rules": [
    {
      "name": "Calculate Nifty Trend Score",
      "priority": 10,
      "market_signals": {
        "allOf": [
          { "fact": "instrument.expiry_cycle", "operator": "equal", "value": "weekly" },
          { "fact": "instrument.instrument_type", "operator": "equal", "value": "index" }
        ]
      },
      "scoring_expression": "market.adx * filters.scoring.combined_score.weight_adx + (market.ema_fast - market.ema_slow) / market.ema_slow * 100 * filters.scoring.combined_score.weight_ema_slope + market.supertrend_dir * filters.scoring.combined_score.weight_supertrend * 10",
      "description": "Combines ADX strength, EMA slope (momentum), and SuperTrend direction for weekly index trend scoring."
    },
    {
      "name": "Calculate Stock Option Score",
      "priority": 15,
      "market_signals": {
        "allOf": [
          { "fact": "instrument.expiry_cycle", "operator": "equal", "value": "monthly" },
          { "fact": "instrument.instrument_type", "operator": "equal", "value": "stock" },
          { "fact": "instrument.derivative", "operator": "equal", "value": "option" }
        ]
      },
      "scoring_expression": "market.adx * filters.scoring.combined_score.weight_adx + (market.ema_fast - market.ema_slow) / market.ema_slow * 100 * filters.scoring.combined_score.weight_ema_slope + market.supertrend_dir * filters.scoring.combined_score.weight_supertrend * 10",
      "description": "Combines ADX strength, EMA slope, and SuperTrend direction for stock option trend scoring."
    }
  ],
  "strategies": [
    {
      "name": "Nifty_FNO_TopN_Trend_Execution",
      "priority": 100,
      "market_signals": {
        "allOf": [
          { "fact": "session.is_trade_window", "operator": "equal", "value": true },
          { "fact": "portfolio.active_positions", "operator": "equal", "value": 0 }
        ]
      },
      "execution_logic": "TOP_N",
      "top_n": "strategy.top_n",
      "scoring_fact": "strategy.trend_score",
      "order_operations": [
        { 
          "type": "trade.place_order", 
          "params": { 
            "derivative": "option",
            "side": "BUY", 
            "product": "MIS",
            "qty": 10,
            "exchange": "NSE",
            "remark": "NIFTY_TOPN_BULL",
            "strike_logic": "ATM+1",
            "option": "CE",
            "expiry": "weekly+0"
          } 
        },
        { 
          "type": "trade.place_order", 
          "params": { 
            "derivative": "option",
            "side": "SELL", 
            "product": "MIS",
            "qty": 10,
            "exchange": "NSE",
            "remark": "NIFTY_TOPN_BEAR",
            "strike_logic": "ATM-1",
            "option": "PE",
            "expiry": "weekly+0"
          } 
        }
      ]
    }
  ]
}
